# OLS推定量の性質と仮説検定 - 練習問題

**対応レクチャー**: lecture_20251015.pdf
**難易度**: ★★☆(中級)
**目標時間**: 90分
**重要度**: S級(試験超重要)

---

## Part 1: 概念理解問題

### 問題1: OLS推定量の望ましい性質

OLS推定量 β̂ が持つ3つの重要な統計的性質について、以下の問いに答えなさい。

(1) **不偏性**とは何か説明し、数式で表しなさい。

(2) **一致性**とは何か説明し、なぜこの性質が重要なのか述べなさい。

(3) **漸近正規性**とは何か説明し、この性質がなぜ仮説検定に必要なのか述べなさい。

#### 📖 ヒント
- 不偏性: 推定量の期待値と真の値の関係
- 一致性: サンプルサイズ n → ∞ のときの振る舞い
- 漸近正規性: 大標本での分布の形

#### ✅ 解答

**(1) 不偏性 (Unbiasedness)**

**定義**: 推定量の期待値が真のパラメータの値と一致する性質。

**数式**: E(β̂) = β

**意味**:
- 同じ実験を何度も繰り返したとき、推定値の平均が真の値に等しい
- 個々の推定値は真の値からずれるが、系統的なバイアス（偏り）はない
- 「平均的には正しい」推定ができている

**(2) 一致性 (Consistency)**

**定義**: サンプルサイズ n を無限に大きくすると、推定量 β̂ が真のパラメータ β に確率的に収束する性質。

**数式**: plim(β̂) = β  または  β̂ →ᵖ β (n → ∞)

**重要性**:
- **データを増やせば真の値に近づく保証**がある
- もし一致性がなければ、どれだけ多くのデータを集めても真の値を知ることができない
- 実証研究の根幹となる性質
- 不偏性がなくても一致性があれば、大標本では信頼できる推定ができる

**(3) 漸近正規性 (Asymptotic Normality)**

**定義**: サンプルサイズ n が大きいとき、OLS推定量の分布が正規分布で近似できる性質。

**数式**: √n(β̂ - β) →ᵈ N(0, V)

ここで、V は漸近分散共分散行列。

**仮説検定における必要性**:
- **検定統計量の分布が既知になる**: t統計量やF統計量が標準正規分布やカイ二乗分布に従うことが示せる
- **p値の計算が可能**: 統計量の値から「偶然では起こりにくい」確率を計算できる
- **信頼区間の構成**: 95%信頼区間などを理論的に構築できる
- 正規分布の性質（対称性、裾の薄さ）により、統計的推論が単純で解釈しやすくなる

---

### 問題2: 分散不均一性の理解（超重要！）

以下の問いに答えなさい。

(1) **分散不均一 (Heteroskedasticity)** とは何か、定義と具体例を挙げて説明しなさい。

(2) **分散均一 (Homoskedasticity)** とは何か定義し、なぜこの仮定は現実的でないのか説明しなさい。

(3) 現代の計量経済学では、どちらの状況を想定すべきか、その理由と共に述べなさい。

#### 📖 ヒント
- レクチャーで最も強調されていたポイント
- Var(u|X) の振る舞いに注目
- 実際の経済データの特徴を考える

#### ✅ 解答

**(1) 分散不均一 (Heteroskedasticity)**

**定義**: 誤差項の分散が説明変数 X の値によって異なる状況。

**数式**: Var(u|X) は X の関数（一定でない）

**具体例**:
- **所得と消費の関係**: 高所得者ほど消費のばらつきが大きい
- **企業規模と利益**: 大企業ほど利益の変動幅が大きい
- **教育年数と賃金**: 高学歴者ほど賃金のばらつきが大きい（職種の多様性）
- **X が大きいほどデータのばらつきが大きくなる**ケースが典型的

**特徴**: 実際の経済データや社会科学のデータでは、分散不均一である方が圧倒的に多いと考えられる。

**(2) 分散均一 (Homoskedasticity)**

**定義**: 誤差項の分散が説明変数 X の値によらず一定である状況。

**数式**: Var(u|X) = σ² (定数)

X の値がどこであっても、データのばらつき方が同じである。

**なぜ現実的でないか**:
- **非常に強い仮定**であり、現実のデータでは稀
- 実際の経済・社会データでは、個人、企業、地域などの異質性により、ばらつきの大きさが異なるのが自然
- 分散が一定であるべき理論的根拠がない場合が多い

**(3) 現代の計量経済学での推奨アプローチ**

**結論**: **常に分散不均一を想定すべき**

**理由**:
1. **現実的**: 実際のデータでは分散不均一が一般的
2. **頑健性**: 分散不均一に対応した手法（頑健な標準誤差）は、分散均一の場合でも正しく機能する
3. **リスク管理**: 分散均一を誤って仮定すると、標準誤差が間違い、検定結果も誤る

**注意**: 古い教科書や一部のソフトウェアのデフォルト設定では、分散均一を仮定した、よりシンプルな分散の計算式が使われている場合があるため、必ず確認すること。分散不均一が一般的な現代の計量経済学では、頑健な推定量を用いることが推奨される。

---

### 問題3: 頑健な標準誤差

以下の文章の正誤を判定し、誤りがあれば訂正しなさい。

(a) 頑健な標準誤差 (Robust Standard Errors) は、分散不均一の場合のみ使用すべきである。

(b) 頑健な標準誤差を使うと、OLS推定量 β̂ 自体の値が変わる。

(c) 講義で紹介された分散の推定式 V̂ は、分散が不均一であっても均一であっても正しく機能する。

(d) 誤差項 u は観測不可能だが、残差 û で置き換えることで分散を推定できる。

#### 📖 ヒント
- 頑健な標準誤差の性質
- OLS推定量と標準誤差の関係
- 一致性の役割

#### ✅ 解答

**(a) 誤り**

**訂正**: 頑健な標準誤差は、**分散不均一でも分散均一でも正しく機能する**ため、常に使用すべきである。

**理由**:
- 分散が均一でも不均一でも一致性を持つ
- 「頑健 (Robust)」とは、分散の構造に依存せず正しい推論ができるという意味
- 事前に分散構造を知ることは困難なため、常に頑健な方法を使う方が安全

**(b) 誤り**

**訂正**: 頑健な標準誤差を使っても、**OLS推定量 β̂ の値は変わらない**。

**説明**:
- β̂ = (X'X)⁻¹X'y という推定式は変わらない
- 変わるのは「β̂ の分散の推定方法」だけ
- つまり、「推定値がどれくらい不確実か」の計算方法が変わるだけ
- 推定値自体は同じで、その信頼区間や検定結果が変わる

**(c) 正しい**

**補足**:
- 講義で紹介された分散の推定式 V̂ は、分散が不均一であっても均一であっても正しく機能するため、「分散不均一に対して頑健（ロバスト）」であると言われる
- これが現代の標準的な推定方法

**(d) 正しい**

**説明**:
- 分散の計算式には観測不可能な誤差項 u が含まれる
- これを観測可能な残差 û で置き換えることで、分散の推定量 V̂ を計算する
- 一致性により、サンプルサイズ n が大きければ β̂ は β に近づき、結果として残差 û も誤差項 u に近づくため、この置き換えは正当化される

---

### 問題4: E(u|X) = 0 の仮定

講義で「E(u|X) = 0 という仮定は非常に強い意味を持つ」と説明されました。

(1) この仮定が何を意味するか説明しなさい。

(2) なぜ社会科学のデータでは、この仮定が強い意味を持つのか説明しなさい。

(3) この仮定が満たされない具体例を1つ挙げなさい。

#### 📖 ヒント
- u には何が含まれるか
- X と u の関係
- 因果推論との関連

#### ✅ 解答

**(1) E(u|X) = 0 の意味**

**意味**: 説明変数 X が与えられたとき、誤差項 u の条件付き期待値が 0 である。

**別の表現**: X と u が無相関である（条件付き期待値の意味で）。

**(2) 社会科学のデータで強い仮定である理由**

**社会科学の特徴**:
- 社会科学のデータでは、誤差項 u には単なる測定誤差だけでなく、モデルに含まれていない（X以外の）全ての Y に影響を与える要因が含まれるため、この仮定は非常に強い意味を持つ

**例**: Y = 賃金、X = 教育年数の場合
- u には以下が全て含まれる: 能力、家庭環境、性別、人種、運、その他賃金に影響する全ての要因
- これらの要因が教育年数と相関している場合、E(u|X) ≠ 0 となる

**(3) 仮定が満たされない具体例**

**例: 大学教育の収益率の推定**

モデル: 賃金ᵢ = β₀ + β₁・大卒ダミーᵢ + uᵢ

**問題点**:
- 大学に進学する人は、平均的に能力が高い（家庭環境が良い、やる気がある、など）
- この「能力」は u に含まれる
- 大卒ダミー（X）と能力（u の一部）は正の相関がある
- したがって、E(u|大卒ダミー=1) > E(u|大卒ダミー=0)
- **結果**: E(u|X) ≠ 0 となり、β̂₁ は大学教育の効果だけでなく、能力の効果も含んでしまう（過大推定）

---

## Part 2: t検定の理解と計算

### 問題5: t検定のメカニズム

t検定の仕組みについて、以下の問いに答えなさい。

(1) t統計量の計算式を示し、各要素が何を意味するか説明しなさい。

(2) 帰無仮説 H₀: βₘ = 0 が**正しい場合**、t統計量はどのような分布に従うか説明しなさい。

(3) 帰無仮説が**間違っている場合**、サンプルサイズ n を大きくすると t統計量はどうなるか説明しなさい。

(4) なぜ |t| > 1.96 を棄却の基準とするのか、説明しなさい。

#### 📖 ヒント
- t統計量の分子と分母の役割
- 漸近正規性との関係
- 標準正規分布の性質

#### ✅ 解答

**(1) t統計量の計算式**

**公式**:
```
t = (β̂ₘ - 仮説の値) / SE(β̂ₘ)
```

通常、仮説の値は0なので:
```
t = β̂ₘ / SE(β̂ₘ)
```

ここで、SE(β̂ₘ) は β̂ₘ の標準誤差 (Standard Error)。

**各要素の意味**:
- **分子 (β̂ₘ - 仮説の値)**: 推定値が仮説の値からどれだけ離れているか
- **分母 SE(β̂ₘ)**: 推定値のばらつき（不確実性）の大きさ
- **t統計量**: 推定値の乖離を不確実性で標準化したもの

**(2) 帰無仮説が正しい場合の t統計量の分布**

**分布**: 漸近的に**標準正規分布** N(0, 1) に従う

**理由**: OLS推定量の漸近正規性より、大標本では t 統計量は平均0、分散1の正規分布に近似される。

**標準正規分布の性質**:
- 約68%が [-1, 1] の範囲に収まる
- 約95%が [-1.96, 1.96] の範囲に収まる
- 約99%が [-2.58, 2.58] の範囲に収まる

したがって、その値は、概ね-2から+2の間に収まる確率が高い。

**(3) 帰無仮説が間違っている場合（n → ∞）**

**結果**: 分子（β̂ₘ - 0）は0でない値に収束し、分母（標準誤差）はサンプルサイズ n の増大と共に0に近づく。結果として、t 統計量の絶対値はプラスまたはマイナスの**無限大に発散**する。

**直感的説明**:
- データが増えると、推定値はより正確になる
- 真の値が仮説の値と異なれば、t は大きくなり続ける
- **十分なデータがあれば、間違った仮説は必ず検出できる**

**(4) |t| > 1.96 を棄却基準とする理由**

**有意水準5%の両側検定**:

標準正規分布において、P(-1.96 < Z < 1.96) ≈ 0.95

**解釈**:
- 帰無仮説が正しい場合、t統計量が [-1.96, 1.96] の外に出る確率は約5%
- もし実際に |t| > 1.96 が観測されたら、「帰無仮説は正しいが、5%の確率で起こる珍しい事象が起きた」か、「帰無仮説が間違っている」のどちらか
- 5%という確率は「偶然では起こりにくい」と判断する基準
- したがって、|t| > 1.96 なら帰無仮説を棄却する

---

### 問題6: 信頼区間の解釈

あるOLS推定で、β̂₁ = 0.5、SE(β̂₁) = 0.2 が得られた。

(1) β₁ の95%信頼区間を計算しなさい。

(2) 以下の解釈のうち、正しいものを選び、誤っているものを訂正しなさい。

  (A) 「真の値 β₁ が95%の確率でこの区間に入る」

  (B) 「同様の実験を100回繰り返すと、95回はこの区間が真の値を含むだろう」

  (C) 「この区間は β₁ = 0 を含まないので、β₁ = 0 という帰無仮説は5%水準で棄却される」

(3) この信頼区間から、t検定で H₀: β₁ = 0.3 という帰無仮説は棄却されるか判定しなさい（有意水準5%）。

#### 📖 ヒント
- 信頼区間の公式: β̂ ± 1.96 × SE
- 信頼区間の頻度論的解釈
- 信頼区間と仮説検定の関係

#### ✅ 解答

**(1) 95%信頼区間の計算**

**公式**:
```
[β̂₁ - 1.96 × SE(β̂₁), β̂₁ + 1.96 × SE(β̂₁)]
```

**計算**:
- 下限: 0.5 - 1.96 × 0.2 = 0.5 - 0.392 = 0.108
- 上限: 0.5 + 1.96 × 0.2 = 0.5 + 0.392 = 0.892

**答え**: [0.108, 0.892] または約 [0.11, 0.89]

**(2) 解釈の正誤判定**

**(A) 誤り**

**訂正**: 「同様の標本抽出を100回繰り返して信頼区間を計算すると、そのうち約95個の区間が真の値 β₁ を含むだろう」

**なぜ誤りか**:
- 真の値 β₁ は**未知の定数**であり、確率的に変動するものではない
- β₁ は区間の中に「いるか、いないか」のどちらかで、確率は0%か100%
- 確率的に変動するのは**区間の方**（データによって変わる）

**(B) 正しい**

**補足**:
- これが信頼区間の**正しい頻度論的解釈**
- 「100回中95回」という頻度的な保証
- 個々の区間が真の値を含むかは不明だが、長期的には95%の確率で含む

講義ノートより: これは「真の値 βₘ が確率的に変動し、95%の確率でこの区間に入る」という意味ではない。真の値 βₘ は未知の定数である。正しくは、「区間自体がデータから計算される確率的なものであり、同様の実験を100回繰り返した場合、そのうち95回はこの区間が真の値を含むだろう」と解釈する。

**(C) 正しい**

**理由**:
- 95%信頼区間は [0.108, 0.892]
- この区間は 0 を含まない（0 < 0.108）
- 信頼区間が仮説の値を含まない ⟺ その値を帰無仮説とするt検定が5%水準で棄却される

**(3) H₀: β₁ = 0.3 の検定**

**方法1: 信頼区間による判定**
- 95%信頼区間: [0.108, 0.892]
- 0.3 はこの区間に含まれる（0.108 < 0.3 < 0.892）
- **結論**: 棄却されない

**方法2: t統計量による判定**
```
t = (β̂₁ - 0.3) / SE(β̂₁) = (0.5 - 0.3) / 0.2 = 1.0
```
- |t| = 1.0 < 1.96（臨界値）
- **結論**: 棄却されない

---

### 問題7: t検定の実践

ある研究者が、教育年数（X）と賃金（Y）の関係を分析し、以下の結果を得た:

```
賃金 = 5.2 + 0.8 × 教育年数
      (0.5) (0.15)
```

括弧内は標準誤差を表す。サンプルサイズは n = 500。

(1) 「教育年数は賃金に影響しない」という帰無仮説 H₀: β₁ = 0 をt検定せよ（有意水準5%）。

(2) 教育年数の係数の95%信頼区間を計算し、経済的に解釈しなさい。

(3) 「教育年数が1年増えると賃金が1増える」という仮説 H₀: β₁ = 1 を検定せよ（有意水準5%）。

#### 📖 ヒント
- t = (推定値 - 仮説の値) / 標準誤差
- 臨界値: 5%水準で 1.96
- 賃金の単位を考慮

#### ✅ 解答

**(1) H₀: β₁ = 0 のt検定**

**計算**:
```
t = (β̂₁ - 0) / SE(β̂₁) = (0.8 - 0) / 0.15 = 5.33
```

**判定**:
- |t| = 5.33 > 1.96（5%水準の臨界値）
- **結論**: 帰無仮説を棄却する

**解釈**:
- 教育年数の係数は統計的に有意に0と異なる
- 教育年数は賃金に有意な影響を与える
- この結果が偶然である確率は極めて低い

**(2) 95%信頼区間の計算と解釈**

**計算**:
```
[β̂₁ - 1.96 × SE(β̂₁), β̂₁ + 1.96 × SE(β̂₁)]
= [0.8 - 1.96 × 0.15, 0.8 + 1.96 × 0.15]
= [0.8 - 0.294, 0.8 + 0.294]
= [0.506, 1.094]
```

約 **[0.51, 1.09]**

**経済的解釈**:
- 教育年数が1年増えると、賃金は平均的に0.51から1.09単位増加する
- 例えば賃金が「万円/年」なら、1年の追加教育で年収が約5.1万円から10.9万円増える
- 区間が0を含まないので、教育の正の効果が確実に存在する

**(3) H₀: β₁ = 1 の検定**

**計算**:
```
t = (β̂₁ - 1) / SE(β̂₁) = (0.8 - 1) / 0.15 = -0.2 / 0.15 = -1.33
```

**判定**:
- |t| = 1.33 < 1.96（5%水準の臨界値）
- **結論**: 帰無仮説を棄却できない

**解釈**:
- β₁ = 1 という値は、データと矛盾しない
- 推定値0.8と仮説の値1の差（-0.2）は、統計的に有意でない
- 「教育年数が1年増えると賃金が1増える」という主張は、データによって否定されない

---

## Part 3: F検定（複合仮説の検定）

### 問題8: なぜt検定の繰り返しはダメか

研究者Aは、回帰モデル Y = β₀ + β₁X₁ + β₂X₂ + β₃X₃ + u において、「β₁ = 0 かつ β₂ = 0 かつ β₃ = 0」という複合仮説を検定したい。

研究者Aは以下のように考えた:
「各係数について個別にt検定を行い（有意水準5%）、少なくとも1つが棄却されたら複合仮説全体を棄却する」

(1) この方法の問題点を説明しなさい。

(2) 3つの検定を全て行うと、誤って棄却する確率（ファミリーワイズエラー率）はどうなるか、概算しなさい。

(3) 正しい検定方法は何か答えなさい。

#### 📖 ヒント
- 個々の検定の有意水準と全体の有意水準
- 多重検定の問題
- F検定の目的

#### ✅ 解答

**(1) 問題点**

**根本的な問題**: 個別の検定の有意水準を5%に設定しても、検定全体で誤りを犯す確率（ファミリーワイズエラー率）が5%にはならず、コントロールできなくなるためである。

**(2) ファミリーワイズエラー率の概算**

**仮定**: 3つの検定が独立（保守的な仮定）

**計算**:
- 各検定で誤って棄却しない確率 = 1 - 0.05 = 0.95
- 3つ全てで誤って棄却しない確率 = 0.95³ = 0.857
- **少なくとも1つで誤って棄却する確率 = 1 - 0.857 = 0.143**

**結論**: 約**14.3%**（名目の5%の約3倍！）

**(3) 正しい検定方法**

**答え**: **F検定（Wald検定）** を用いる

**F検定の特徴**:
- 複合仮説を一度に検定
- 係数間の相関を考慮
- 有意水準が保証される（5%水準で検定すれば、誤って棄却する確率は5%）

---

### 問題9: F検定の理解

F検定について、以下の問いに答えなさい。

(1) Wald統計量 W とF統計量の関係を説明しなさい。

(2) 帰無仮説が正しい場合、W統計量はどのような分布に従うか答えなさい。

(3) F統計量を使う利点を、臨界値の観点から説明しなさい。

(4) 制約の数 q が増えても、F統計量の棄却の目安が大きく変動しない理由を説明しなさい。

#### 📖 ヒント
- W = F × q の関係
- 漸近分布の性質
- 自由度の役割

#### ✅ 解答

**(1) Wald統計量とF統計量の関係**

**関係式**:
```
F = W / q
```
ここで、
- W: Wald統計量
- q: 制約の数（検定する線形制約の数）
- F: F統計量

**Wald統計量の定義**:
```
W = (Rβ̂ - r)' [R V̂ R']⁻¹ (Rβ̂ - r)
```

これは、Rβ̂-r がどれだけ0から離れているかを、係数間の相関を考慮した「距離」（二次形式）で測るものである。

**(2) W統計量の分布（帰無仮説が正しい場合）**

**分布**: 漸近的に**カイ二乗分布** χ²(q) に従う

**数式**: W →ᵈ χ²(q)  (n → ∞)

ここで、自由度 q は制約の数。

帰無仮説が正しい場合、W統計量は自由度q（制約の数）のカイ二乗分布に漸近的に従う。一方、帰無仮説が間違っている場合、W統計量は無限大に発散する。

**(3) F統計量を使う利点**

**利点**: F統計量は、自由度q（制約の数）が変わっても棄却の目安となる値が大きく変動せず、多くの場合「およそ4」を超えるかどうかで大まかな判断ができるため、直感的に解釈しやすい。

W統計量の臨界値は制約の数 q によって大きく変わるが、F = W/q とすることで、臨界値がおおむね一定になる。

**(4) F統計量の棄却の目安が安定している理由**

**理由**:
- カイ二乗分布 χ²(q) の臨界値は q に比例して増えるが、それより遅いペース
- F = W/q = χ²/q なので、分子と分母が共に増加し、結果として F の臨界値は比較的安定
- 実務的には、q が小さい場合（1-5程度）、F > 3-4 が棄却の目安

**具体例**（5%水準の臨界値）:
| 制約の数 q | χ²(q)の臨界値 | F の目安 (χ²/q) |
|-----------|-------------|----------------|
| 1         | 3.84        | 3.84           |
| 2         | 5.99        | 3.00           |
| 3         | 7.81        | 2.60           |
| 5         | 11.07       | 2.21           |

---

### 問題10: F検定の実践

ある研究者が、住宅価格（Y）を説明するために以下のモデルを推定した:

```
価格 = β₀ + β₁×面積 + β₂×築年数 + β₃×駅距離 + β₄×部屋数 + u
```

推定結果として以下が得られた（標準誤差は省略）:
- β̂₁ = 50, β̂₂ = -30, β̂₃ = -20, β̂₄ = 100
- Wald統計量（H₀: β₂ = 0 かつ β₃ = 0 かつ β₄ = 0）= 15.6

(1) 「築年数、駅距離、部屋数は住宅価格に影響しない」という仮説を、F検定を用いて検定しなさい（有意水準5%）。

(2) この検定で使うF統計量を計算しなさい。

(3) もし研究者が3つの係数について個別にt検定を行い、全て棄却されたとする。これだけで複合仮説を棄却して良いか、説明しなさい。

#### 📖 ヒント
- 制約の数 q = 3
- F = W / q
- χ²(3)の5%臨界値は約7.81

#### ✅ 解答

**(1) F検定による複合仮説の検定**

**帰無仮説**: H₀: β₂ = 0 かつ β₃ = 0 かつ β₄ = 0
（築年数、駅距離、部屋数は価格に影響しない）

**制約の数**: q = 3

**判定基準**:
- Wald統計量 W = 15.6
- カイ二乗分布の臨界値: χ²(3) の5%点 ≈ 7.81
- W = 15.6 > 7.81

**結論**: **帰無仮説を棄却する**

**解釈**:
- 築年数、駅距離、部屋数の少なくとも1つは、住宅価格に有意な影響を与える
- この3つの変数を同時に全てモデルから除外することはできない

**(2) F統計量の計算**

**公式**:
```
F = W / q = 15.6 / 3 = 5.2
```

**答え**: **F = 5.2**

**判定**:
- F = 5.2 は、「およそ4」の目安を超えている
- これは偶然では起こりにくい（p < 0.05）

**(3) 個別のt検定の結果だけで判断して良いか**

**答え**: **No、十分ではない**

**理由**:

1. **多重検定の問題**: 3つの個別検定を行うと、ファミリーワイズエラー率が5%を超える（約14.3%）

2. **有意水準が保証されない**: たとえ全て棄却されても、全体として5%水準で検定したとは言えない

3. **係数間の相関を無視**: β̂₂、β̂₃、β̂₄ は互いに相関している可能性があり、個別検定では、この相関構造を考慮できない

4. **正しいアプローチ**:
   - まず**F検定で複合仮説を検定**（全体として意味があるか）
   - F検定が棄却されたら、**事後的に個別のt検定**で各係数を評価（どれが重要か）

---

## Part 4: R²の理解

### 問題11: 決定係数の性質

決定係数 R² について、以下の問いに答えなさい。

(1) R² の定義と、その値の範囲を答えなさい。

(2) 説明変数を追加すると、R² はどうなるか答えなさい。

(3) なぜ R² だけではモデルの良し悪しを判断できないのか説明しなさい。

(4) 自由度調整済み決定係数（Adjusted R²）は、通常の R² とどう異なるか説明しなさい。

#### 📖 ヒント
- R² = 説明できた変動 / 全変動
- 変数追加の効果
- 当てはまりと因果関係の区別

#### ✅ 解答

**(1) R² の定義と値の範囲**

**定義**: 被説明変数 Y の全変動のうち、モデル（説明変数 X）によって説明できた部分の割合を示す指標。

**値の範囲**: **0 ≤ R² ≤ 1**

- **R² = 1**: 完全な当てはまり（全てのデータ点が回帰線上）
- **R² = 0**: 全く当てはまらない
- 通常は 0 < R² < 1

**(2) 説明変数を追加すると R² はどうなるか**

**答え**: R² は**必ず増加する（または非減少）**

**理由**: 説明変数を追加すると、R² は必ず増加（または非減少）する。たとえ無意味な変数を加えても値が上昇するため、モデルの良し悪しの判断には使えない。

**(3) R² だけではモデルの良し悪しを判断できない理由**

**理由**: R² はあくまで当てはまりの良さの一つの側面に過ぎず、この値が高いからといってそのモデルが因果関係を正しく捉えているとは限らない点に注意が必要である。

**具体的な問題点**:
- 当てはまりの良さと因果関係は別物
- 無関係な変数を追加しても R² は上がる
- 過剰適合 (Overfitting) の危険性
- R² が高くても内生性の問題は解決されない

**(4) 自由度調整済み決定係数 (Adjusted R²)**

**通常の R² との違い**:

| 項目 | R² | Adjusted R² |
|------|----|----|
| 変数追加時 | 必ず増加 | 減少する場合もある |
| ペナルティ | なし | 変数の数にペナルティ |
| 値の範囲 | [0, 1] | 負になることもある |

**説明**:
- 上記の問題を緩和するため、説明変数の数でペナルティを課した指標
- 安易に変数を増やすと、この値は逆に低下することがある
- 通常の R² よりも低い値をとり、場合によっては負になることもある

---

## 📚 総合復習問題

### 問題12: レクチャー全体の統合

以下の総合問題に答えなさい。

ある経済学者が、最低賃金（MW）の引き上げが失業率（UR）に与える影響を分析するため、50州のデータを用いて以下のモデルを推定した:

```
URᵢ = β₀ + β₁MWᵢ + β₂GDPᵢ + β₃Educᵢ + uᵢ
```

ここで、GDPᵢ は州のGDP成長率、Educᵢ は大卒比率である。

推定結果:
- β̂₁ = 0.5, SE(β̂₁) = 0.3 (頑健な標準誤差を使用)
- β̂₂ = -0.8, SE(β̂₂) = 0.2
- β̂₃ = -0.3, SE(β̂₃) = 0.4
- R² = 0.45
- F統計量（全係数=0の検定）= 12.3

(1) なぜこの分析で頑健な標準誤差を使用すべきか説明しなさい。

(2) 「最低賃金は失業率に影響しない」という仮説（H₀: β₁ = 0）を検定し、95%信頼区間を計算しなさい。

(3) 「GDP成長率と大卒比率は同時に失業率に影響しない」という仮説を検定するには、どのような手順が必要か説明しなさい（Wald統計量が6.5と与えられたとする）。

(4) R² = 0.45 という値から、このモデルの因果的妥当性を判断できるか説明しなさい。

(5) E(u|X) = 0 の仮定が満たされない可能性について、この研究の文脈で具体的に論じなさい。

#### ✅ 解答

**(1) 頑健な標準誤差を使用すべき理由**

**この研究の文脈**:
- **州間の異質性**: 50州は経済規模、産業構造、労働市場の特性が大きく異なる
- **分散不均一の可能性**: 大きな州は失業率の変動も大きい一方、小さな州は変動が小さい可能性
- **観察データ**: 実験データではないので、誤差の構造が複雑

**一般的理由**:
- 現実のデータでは分散不均一が一般的
- 頑健な標準誤差は分散均一でも不均一でも正しく機能する
- 分散均一を誤って仮定すると、標準誤差が不正確になり、検定結果も誤る

**(2) H₀: β₁ = 0 の検定と信頼区間**

**t検定**:
```
t = (β̂₁ - 0) / SE(β̂₁) = 0.5 / 0.3 = 1.67
```

**判定**（5%水準、両側検定）:
- |t| = 1.67 < 1.96（臨界値）
- **結論**: 帰無仮説を棄却できない

**95%信頼区間**:
```
[β̂₁ - 1.96 × SE(β̂₁), β̂₁ + 1.96 × SE(β̂₁)]
= [0.5 - 1.96 × 0.3, 0.5 + 1.96 × 0.3]
= [0.5 - 0.588, 0.5 + 0.588]
= [-0.088, 1.088]
```

約 **[-0.09, 1.09]**

**解釈**:
- 最低賃金の効果は、5%水準で統計的に有意でない
- 真の効果 β₁ は、-0.09 から 1.09 の範囲にあると推測される
- 信頼区間が0を含むため、「効果がない」という仮説は棄却されない
- 効果の符号すら不確実（マイナスもプラスも可能性がある）

**(3) 複合仮説 H₀: β₂ = 0 かつ β₃ = 0 の検定**

**手順**:

**Step 1**: F検定（Wald検定）の実施
- 制約の数: q = 2
- 与えられた Wald統計量: W = 6.5

**Step 2**: F統計量の計算
```
F = W / q = 6.5 / 2 = 3.25
```

**Step 3**: 判定
- カイ二乗分布の臨界値: χ²(2) の5%点 = 5.99
- W = 6.5 > 5.99
- **結論**: 棄却

または F統計量で:
- F = 3.25 ≈ 3-4（ボーダーライン）
- **結論**: 棄却（ただしギリギリ）

**Step 4**: 解釈
- 少なくともGDP成長率か大卒比率のどちらかは、失業率に有意な影響を与える
- 両方をモデルから除外することはできない

**(4) R² = 0.45 から因果的妥当性を判断できるか**

**答え**: **No、判断できない**

**理由**:
- R² は当てはまりの指標であり、因果関係の指標ではない
- R² = 0.45 は「失業率の変動の45%がモデルで説明される」という意味
- これは予測精度に関する情報であり、因果関係の正しさとは別問題
- R² が高くても内生性があれば因果効果は正しく推定されない
- R² が低くても因果関係が正しい場合もある（ランダム化比較試験など）

**(5) E(u|X) = 0 の仮定が満たされない可能性**

**最も懸念される問題: 欠落変数バイアス**

**具体例1: 労働組合の加入率**
- 労働組合が強い州は:
  - 最低賃金が高い傾向（MW と正相関）
  - 労働市場が硬直的で失業率が高い（UR と正相関）
- 労働組合加入率が u に含まれるなら: E(u|MW が高い) > 0
- 結果として β̂₁ は過大推定される

**具体例2: 産業構造**
- サービス業が多い州は最低賃金の影響を受けやすく、失業率の変動も大きい可能性
- 産業構造が u に含まれるなら内生性の問題

**具体例3: 逆の因果**
- 失業率が高い州で、政治的圧力から最低賃金を引き上げる
- UR → MW の因果があると、E(u|MW) ≠ 0

**検討すべき対策**:
- 追加の制御変数（労働組合加入率、産業構造など）
- 固定効果モデル（州固有の観察されない要因を制御）
- 操作変数法（内生性の問題を解決）
- 差分の差分法（最低賃金引き上げの前後比較）

**結論**: このクロスセクションモデルでは、E(u|X) = 0 の仮定が満たされていない可能性が高く、より高度な因果推論手法が必要

---

## 🎯 学習到達度チェックリスト

### レベル1: 基礎理解
- [ ] OLS推定量の3つの性質（不偏性、一致性、漸近正規性）を説明できる
- [ ] 分散不均一と分散均一の違いを説明できる
- [ ] 頑健な標準誤差がなぜ重要か説明できる
- [ ] t統計量の計算式を書ける
- [ ] 信頼区間の正しい解釈ができる
- [ ] R² の定義と限界を説明できる

### レベル2: 実践力
- [ ] t検定を実際に計算し、判定できる
- [ ] 信頼区間を計算し、経済的に解釈できる
- [ ] なぜt検定の繰り返しがダメか説明できる
- [ ] F統計量とWald統計量の関係を理解している
- [ ] F検定を実際に行える
- [ ] Adjusted R² の意味を理解している

### レベル3: 批判的理解
- [ ] E(u|X) = 0 の仮定の意味と、満たされない例を説明できる
- [ ] 信頼区間の頻度論的解釈を正確に説明できる
- [ ] t検定とF検定のメカニズムを、漸近理論の観点から説明できる
- [ ] R² の高さと因果的妥当性が別物であることを説明できる
- [ ] 実証研究の結果を批判的に評価できる
- [ ] 内生性の問題を具体的な文脈で議論できる

---

## 💡 重要ポイントまとめ

### 🔥 試験で最も重要な3点

1. **分散不均一性への対応**
   - 現代の計量経済学では、常に頑健な標準誤差を使用
   - 分散均一の仮定は非現実的
   - これを理解していないと、全ての推論が誤る

2. **t検定とF検定の使い分け**
   - 単一の係数 → t検定
   - 複数の係数を同時に → F検定（t検定の繰り返しはダメ）
   - 信頼区間と仮説検定は表裏一体

3. **E(u|X) = 0 の重要性**
   - この仮定が満たされないと、OLS推定量は不偏でも一致でもなくなる
   - 欠落変数、逆の因果、測定誤差などで破れる
   - 因果推論の核心的な問題

### 📌 よくある誤解

| 誤解 | 正しい理解 |
|------|-----------|
| 信頼区間は真の値が95%の確率で入る範囲 | 同様の標本抽出を繰り返すと、95%の区間が真の値を含む |
| 分散不均一のときだけ頑健な標準誤差を使う | 常に使うべき（分散均一でも機能する） |
| 個別のt検定を繰り返せば複合仮説を検定できる | F検定を使わないと有意水準が保証されない |
| R² が高いモデルは良いモデル | 当てはまりと因果的妥当性は別 |
| 有意でない = 効果がない | 検出力の問題の可能性もある |

---

**このセットを完璧にマスターすれば、OLS推定の理論と実践の基礎は万全！**
